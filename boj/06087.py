# 06087 ë‹¤ìµìŠ¤íŠ¸ë¼? í‘œ íƒìƒ‰
import heapq
import sys
input = sys.stdin.readline

WALL = 8
END = 1
ROAD = 0

# crt+1 + 
# [0]:ì˜¤ë¥¸, [1]:ì•„ë˜, [2]:ì™¼ìª½, [3]:ìœ„
# [0]:ì•„ë˜, [1]:ì˜¤ë¥¸, [2]:ìœ„ìª½, [3]:ì™¼
dx = [1, 0, -1, 0]
dy = [0, 1, 0, -1]

cnt = -1;
def toggle():
    global cnt;
    cnt += 1;
    return cnt;

def main():
    # ì…ë ¥ë¶€
    col, row = map(int, input().split())
    board_origin = []
    for _ in range(row):
        tmp = input()
        board_origin.append(tmp)
    # ìë£Œêµ¬ì¡°
    endPoint = [0,0]

    # ê·¸ë˜í”„ ë§Œë“¤ê¸°
    def init_graph(road, end, wall):
        # graph ë§Œë“¤ê¸°
        switch = {'.':road,'C':end,'*':wall,'\n':wall}
        graph = [[wall]*(col+2)]
        for idx_r, line in enumerate(board_origin):
            tmp=[wall]
            for idx_c, c in enumerate(line):
                tmp.append(switch[c])
                if c=='C':
                    endPoint[toggle()] = [idx_r+1, idx_c+1]

            graph.append(tmp)

        graph.append([wall]*(col+2))
        return graph;
    graph = init_graph(END, ROAD, WALL)

    # ì‹œì‘ì ì—ì„œ ë‹¤ìµìŠ¤íŠ¸ë¼ ì‹¤í–‰í•˜ê¸°
    def dijkstra():
        # ìµœë‹¨ê±°ë¦¬ ì €ì¥í•˜ëŠ” ë°°ì—´, ë°©í–¥ ì €ì¥ ë°°ì—´
        distance = [[float('inf') for _ in range(col+2)] for _ in range(row+2)]
        dxdy = [[WALL for _ in range(col+2)] for _ in range(row+2)]
        # ì²« ìœ„ì¹˜ë¡œ ì´ˆê¸°í™”í•˜ê¸°
        distance[endPoint[0][0]][endPoint[0][1]] = 0
        q = []

        # ìƒí•˜ì¢Œìš° ë„£ê¸°
        for i in range(4):
            # ë²½ì´ë©´ ë„£ì§€ë§ˆ, ì•„ë‹ˆë©´ qì— ë„£ì–´
            if graph[endPoint[0][0]+dx[i]][endPoint[0][1]+dy[i]] != WALL:
                # distanceì™€ dxdyë¥¼ ì´ˆê¸°í™”í•œë‹¤.
                distance[endPoint[0][0]+dx[i]][endPoint[0][1]+dy[i]] = 0;
                dxdy[endPoint[0][0]+dx[i]][endPoint[0][1]+dy[i]] = i;
                # (ë°©í–¥, í˜„ì¬ ë…¸ë“œì˜ ê°€ì¤‘ì¹˜, í˜„ì¬ë…¸ë“œ=[ì¢Œí‘œ, ì¢Œí‘œ])
                heapq.heappush(q, (i,0,[endPoint[0][0]+dx[i],endPoint[0][1]+dy[i]]))

        # í ìˆœíšŒí•˜ê¸°
        while q:
            # for line in distance:
            #     for c in line:
            #         print("{0:3d},".format(c), end='')
            #     print()
            # print('==================================')
            # ë‹¤ìŒ ë…¸ë“œë¡œ ì´ë™í•˜ê¸°

            # print(q)
            crt_direct, crt_cost, coor = heapq.heappop(q)
            crt_r, crt_c = coor
            # í˜„ì¬ ìœ„ì¹˜ì—ì„œ ë‹¤ìŒ ë™ì„  ê°±ì‹  ê°€ëŠ¥í•œì§€ ìˆœíšŒí•˜ê¸°
            for delta in range(4):
                if graph[crt_r+dx[delta]][crt_c+dy[delta]] != WALL: # ë²½ì´ ì•„ë‹ˆë©´ ì „ì§„
                    next_cost = distance[crt_r+dx[delta]][crt_c+dy[delta]]
                    next_dxdy = dxdy[crt_r+dx[delta]][crt_c+dy[delta]]

                    if crt_direct == delta: # ê°™ì€ ë°©í–¥ì´ë¼ë©´ ê°€ì¤‘ì¹˜ ë”í•˜ê¸°x
                        # í˜„ì¬ ê°€ì¤‘ì¹˜ + ë‹¤ìŒ ê°€ì¤‘ì¹˜ < ë‹¤ìŒ ë…¸ë“œì˜ distanceë³´ë‹¤ ì‘ìœ¼ë©´ íì— ë„£ê¸°
                        if (crt_cost < next_cost if ((next_dxdy+2)%4 == crt_direct)or(next_dxdy == crt_direct) else crt_cost <= next_cost) : # ì—­ë°©í–¥ì´ê±°ë‚˜ ìˆœë°©í–¥ì´ë©´ ì‘ì„ë•Œ ê°±ì‹ 
                            # ì¼ë‹¨ í›„ë³´êµ°ì— ë„£ì–´
                            heapq.heappush(q, (delta, crt_cost, [crt_r+dx[delta],crt_c+dy[delta]]))
                            # ì¼ë‹¨ í›„ë³´êµ°ì˜ distanceë¥¼ ê°±ì‹ í•˜ê¸°
                            distance[crt_r+dx[delta]][crt_c+dy[delta]] = crt_cost
                            continue;
                    elif crt_direct == (delta+2)%4: # ë°˜ëŒ€ ë°©í–¥ì´ë©´ ë„£ì§€ ì•Šê¸°
                        continue;
                    else: # ì¢Œìš°ë¼ë©´ ê°€ì¤‘ì¹˜ + 1
                        # í˜„ì¬ ê°€ì¤‘ì¹˜ + ë‹¤ìŒ ê°€ì¤‘ì¹˜ < ë‹¤ìŒ ë…¸ë“œì˜ distanceë³´ë‹¤ ì‘ìœ¼ë©´ íì— ë„£ê¸°
                        if (crt_cost + 1 < next_cost if ((next_dxdy+2)%4 == crt_direct)or(next_dxdy == crt_direct) else crt_cost + 1 <= next_cost): 
                            # ì¼ë‹¨ í›„ë³´êµ°ì— ë„£ì–´
                            heapq.heappush(q, (delta, crt_cost+1, [crt_r+dx[delta],crt_c+dy[delta]]))
                            # ì¼ë‹¨ í›„ë³´êµ°ì˜ distanceë¥¼ ê°±ì‹ í•˜ê¸°
                            distance[crt_r+dx[delta]][crt_c+dy[delta]] = crt_cost + 1
                            continue;

        # ê·¸ë˜í”„ ë””ë²„ê¹…
        # for line in graph:
        #     for c in line:
        #         print(str(c)+' ', end='')
        #     print()
        
        return distance[endPoint[1][0]][endPoint[1][1]]
    result = dijkstra()
    return result;

if __name__ == '__main__':
    print(main())

'''
ğŸ¯ ì…ì¶œë ¥
    ì…ë ¥ : max >> 100*100 ì‚¬ì´ì¦ˆ í‘œ ì…ë ¥
    ì¶œë ¥ : í•„ìš”í•œ ê±°ìš¸ì˜ ê°¯ìˆ˜
ğŸ”¥ ì•Œê³ ë¦¬ì¦˜
    ë¸íƒ€íƒìƒ‰?, ë‹¤ìµìŠ¤íŠ¸ë¼(ê°€ì¤‘ì¹˜ê°€ ì„œë¡œ ë‹¤ë¦„), 
    ì „ì§„ì´ ì•„ë‹Œ êº½ì´ëŠ” ìƒí™©ì—ì„œ ê°€ì¤‘ì¹˜ë¥¼ 1 ì˜¬ë¦°ë‹¤.
        ìœ ë™ì ìœ¼ë¡œ ê°€ì¤‘ì¹˜ ë§Œë“¤ê¸°
    ë‹¤ìµìŠ¤íŠ¸ë¼ì˜ ìµœì†Œí™ì„ ì‚¬ìš©í•´ì„œ ë‹¤ìŒ íƒìƒ‰í•  ê³µê°„ì„ ì°¾ëŠ”ë‹¤.
    1. í˜„ì¬ ìœ„ì¹˜ì—ì„œ ë‹¤ìŒ ìœ„ì¹˜ í›„ë³´êµ°ì„ ìµœì†Œí™ì— ë„£ëŠ”ë‹¤.
    2. ë‹¤ìŒ ìœ„ì¹˜ëŠ” ìµœì†Œí™.popì´ ì •í•´ì£¼ê¸° ë•Œë¬¸ì— ì‹ ê²½ì“°ì§€ ë§ê³  popí•˜ì
    3. cì— ë„ì°©í•˜ë©´, cì˜ ê°’ ì¶œë ¥
ğŸ“š ìë£Œêµ¬ì¡°
    ë‹¤ìµìŠ¤íŠ¸ë¼ë¥¼ ìœ„í•œ ìë£Œêµ¬ì¡°
        ìµœì†Œí™, distance
        í˜„ì¬ ìœ„ì¹˜ + ë‹¤ìŒ ìœ„ì¹˜ì˜ ê°€ì¤‘ì¹˜ = cst
    ê·¸ë˜í”„ í‘œí˜„ ë°©ë²•
        ê²‰ì€ ë²½ìœ¼ë¡œ í•œ ë²ˆ ê°ì‹¸ëŠ” í¸ì´ ë” í¸í•˜ê²Œ íƒìƒ‰í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.
        w, hê°€ ì£¼ì–´ì§€ë‹ˆ w+2, h+2 í¬ê¸°ì˜ ë°°ì—´ì„ ë§Œë“¤ì
        ìˆ«ìë¡œ ë³€ê²½í•´ì„œ ì €ì¥í•œë‹¤.
        {',':0, 'C':1, '*':-1}
    dijkstra(){
        # ì´ˆê¸° ì„¤ì •í•˜ê¸°
        í
        ìµœì €ê±°ë¦¬ ì €ì¥ ë°°ì—´
        # í ì„ íšŒí•˜ê¸°
        í˜„ì¬ ê±°ë¦¬
    }
    heapq.heappush(q, (delta, crt_cost, [crt_r+dx[delta],crt_c+dy[delta]]))
    >> (ë°©í–¥, í˜„ì¬ ë…¸ë“œì˜ ê°€ì¤‘ì¹˜, í˜„ì¬ë…¸ë“œ=[ì¢Œí‘œ, ì¢Œí‘œ])
    
â›”ï¸ ì‹¤íŒ¨
    1. íƒìƒ‰ ë„ì¤‘ out of indexë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ ë²½ìœ¼ë¡œ ë‘˜ëŸ¬ìŒ“ì•˜ê¸° ë•Œë¬¸ì— endpointì™€ ë™ê¸°í™”ê°€ ì•ˆ ë˜ì—ˆë‹¤.
        >> endPointì˜ x, y ì¢Œí‘œë¥¼ í•œ ê°œì”© ë”í•´ì£¼ì—ˆë‹¤.
    2. ì²˜ìŒ ì‹œì‘í•  ë•Œ ì„ì˜ë¡œ 1ì˜ ë°©í–¥ìœ¼ë¡œ ì§€ì •í•˜ê³  ì›€ì§ì„ì„ ì£¼ì—ˆë”ë‹ˆ ì²˜ìŒ ìœ„ì¹˜ì—ì„œ ì²« ë°œê±¸ìŒì˜ ê°€ì¤‘ì¹˜ê°€ 1ì´ ë˜ì–´ë²„ë¦¬ëŠ” ìƒí™©ì´ ë˜ì–´ì„œ ì´ìƒí•´ì§„ë‹¤.
        >> ê°€ì¥ ì²« ë°œê±¸ìŒì—ì„œ ìƒí•˜ì¢Œìš°ì˜ ë…¸ë“œë¥¼ ë¯¸ë¦¬ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.
    3. ëª©ì ì§€ì— ë„ì°©í•˜ìë§ˆì ë£¨í”„ë¥¼ ë¹ ì ¸ë‚˜ì˜¤ê²Œ ë§Œë“¤ì—ˆë‹¤. ìµœì†Œê°€ì¤‘ì¹˜ì¸ ìƒíƒœë¡œ ë²½ì— ë¶€ë”ªíˆë©´ ì˜†ì— ìˆëŠ” ê°’ì„ ê°±ì‹ í•œë‹¤. ê·¸ë•Œ ëª©ì ì§€ê°€ ìˆë‹¤ë©´ ìµœì†Ÿê°’ì„ ì°¾ì§€ ì•Šê³  ì¢…ë£Œì‹œí‚¨ë‹¤.
        >> ê·¸ëƒ¥ íê°€ ë¹Œë•Œê¹Œì§€ whileì„ ëŒë¦¬ë©´ ëœë‹¤.
    4. ê°€ì¤‘ì¹˜ê°€ ì‘ì•„ì§ˆë•Œë§Œ ë®ì–´ì”Œìš°ê³  íì— ë„£ì—ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ xìë¡œ êµì°¨ë˜ëŠ” ìƒíƒœì—ì„œ í•˜ë‚˜ì˜ ë°©í–¥ì„ ë²„ë ¤ì•¼í–ˆë‹¤.
        >> ê°™ê±°ë‚˜ ì‘ì•„ì§ˆë–„ ë®ì–´ì”Œìš°ê³  íì— ë„£ì.
    5. ê°™ê±°ë‚˜ ì‘ì•„ì§ˆ ë•Œ ë®ì–´ì”Œìš°ë©´ ê°™ì„ ë•Œì—ë„ íì— ë„£ê²Œ ëœë‹¤. ê·¸ëŸ¬ë©´ ë„ˆë¬´ ë§ì€ í›„ë³´ë“¤ì„ ë„£ê²Œ ë˜ë‚˜?
        >> ì§ê°ì¼ ë•Œë§Œ ì‘ê±°ë‚˜ ê°™ë‹¤ë¥¼ ì ìš©í•˜ì +-1ì„ 4ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ì¼ë•Œë©´ ì‘ê±°ë‚˜ ê°™ë‹¤ ì ìš©í•˜ê¸°
    6. íŠ¹ì •í•œ tcì—ì„œ ë„ˆë¬´ ë§ì€ ê°’ë“¤ì´ íì— ìŒ“ì¸ë‹¤. ì™œ ìŒ“ì´ëŠ”ê±°ì§€?
        >> 100 7 ì‚¬ì´ì¦ˆì˜ ì¸í’‹ì„ ë„£ìœ¼ë©´ íì— ì¤‘ë³µëœ ê°’ì´ ë„ˆë¬´ ë§ì•„ì§„ë‹¤. ë¶„ê¸°ì ì—ì„œ ë¶„ê¸°í•˜ê³  í•œ ê³³ì— ëª¨ì´ê³  ëª¨ì¸ ê³³ì—ì„œ ê°ê° ë¶„ê¸°í•˜ë©´ 2ë°°ê°€ ëœë‹¤.
        >> (next_dxdy+2%4) ê´„í˜¸ë¥¼ ì•ˆ ì³¤ë‹¤.
    7. dx, dyë¥¼ í—·ê°ˆë ¸ë„¤? ê´œì°®ê² ì§€~
    
ğŸ² test case
    >> input
7 8
.......
......C
......*
*****.*
....*..
....*..
.C..*..
.......
    << output
3
    
    >> input
4 6
.C..
....
....
**.*
....
...C
    << output
2

    >> input
100 7
...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*
C*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*.*
...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*
**************************************************************************************************.*
...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*
C*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*.*
...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*...*
    << output
196
    
'''